<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script type="text/javascript" src="./jquery.js"></script>
	 <script src="./echarts.min.js"></script>
</head>
<body>
	 <div id="main" style="width: 800px;height:600px;"></div>
</body>
<script type="text/javascript">
	
    var upColor = '#00da3c';
    var downColor = '#ec0000';






    let categories = [{name:'温度'},{name:'压力'},{name:'合力'},{name:'气压'},{name:'电力'}];

    var data = [/*{
        "id": "传感器id",
        "name": "各传感器名称",
        "itemStyle": null,
        "symbolSize": '传感器异常次数',
        "attributes": {
            "modularity_class": 0
        },
        "value": '传感器异常次数',
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": '同一类目的'
    },*/ 
    {
        "id": "0",
        "name": "各传感器",
        "itemStyle": null,
        "symbolSize": 40,
        "attributes": {
            "modularity_class": 0
        },
        "value": 10,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 0
    },
    {
        "id": "4",
        "name": "显示的项目",
        "itemStyle": null,
        "symbolSize": 8,
        "attributes": {
            "modularity_class": 0
        },
        "value": 8,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 0
    },
    {
        "id": "5",
        "name": "显示的项目",
        "itemStyle": null,
        "symbolSize": 10,
        "attributes": {
            "modularity_class": 0
        },
        "value": 10,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 0
    },
    {
        "id": "a",
        "name": "显示的项目6",
        "itemStyle": null,
        "symbolSize": 12,
        "attributes": {
            "modularity_class": 0
        },
        "value": 12,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 0
    },
     {
        "id": "7",
        "name": "显示的项目",
        "itemStyle": null,
        "symbolSize": 14,
        "attributes": {
            "modularity_class": 0
        },
        "value": 14,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 0
    },
    {
        "id": "1",
        "name": "sfsdg",
        "itemStyle": null,
        "symbolSize": 22,
        "attributes": {
            "modularity_class": 0
        },
        "value": 22,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 1
    }, 
    {
        "id": "8",
        "name": "hsdfsd",
        "itemStyle": null,
        "symbolSize": 25,
        "attributes": {
            "modularity_class": 0
        },
        "value": 25,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 1
    },
    {
        "id": "9",
        "name": "ertyui",
        "itemStyle": null,
        "symbolSize": 20,
        "attributes": {
            "modularity_class": 0
        },
        "value": 20,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 1
    },
    {
        "id": "10",
        "name": "sdfgrerdc",
        "itemStyle": null,
        "symbolSize": 18,
        "attributes": {
            "modularity_class": 0
        },
        "value": 18,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 1
    },
    {
        "id": "15",
        "name": "sdfg",
        "itemStyle": null,
        "symbolSize": 16.323809333333333,
        "attributes": {
            "modularity_class": 0
        },
        "value": 23.485714,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 2
    }, 
    {
        "id": "2",
        "name": "dfghj",
        "itemStyle": null,
        "symbolSize": 16,
        "attributes": {
            "modularity_class": 0
        },
        "value": 16,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 2
    },
    {
        "id": "12",
        "name": "erfgbn",
        "itemStyle": null,
        "symbolSize": 18,
        "attributes": {
            "modularity_class": 0
        },
        "value": 18,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": 2
    },
    {
        "id": "13",
        "name": "hello",
        "itemStyle": null,
        "symbolSize": 30,
        "attributes": {
            "modularity_class": 0
        },
        "value": 30,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category":2
    },
    {
        "id": "14",
        "name": "hello 14",
        "itemStyle": null,
        "symbolSize": 37,
        "attributes": {
            "modularity_class": 0
        },
        "value": 37,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category":2
    },
    {
        "id": "11",
        "name": "hello",
        "itemStyle": null,
        "symbolSize": 36,
        "attributes": {
            "modularity_class": 0
        },
        "value": 36,
        "label": {
            "normal": {
                "show": true
            }
        },
        "category":2
    }];
    var myChart = echarts.init(document.getElementById('main'));
    //let categories = [{name:'类目1'},{name:'类目2'},{name:'类目3'}];
    let option = {
         title: {
            text: 'Les Miserables',
            subtext: 'Circular layout',
            top: 'bottom',
            left: 'right'
        },
        tooltip: {},
        legend: [{
            // selectedMode: 'single',
            data: categories.map(function (a) {
                return a.name;
            })
        }],
        animationDuration: 1500,
        animationEasingUpdate: 'quinticInOut',
        series : [
        {
            name: '鼠标滑过显示的标题',
            type: 'graph',
            layout: 'circular',
            circular: {
                rotateLabel: true
            },
            data: data,
            links: [
            {
                source: '14',
                lineStyle:{
                    color:'red',
                    width:10
                },
                target: '0'
            }, {
                source: '14',
                target: '15'
            },{
                source: '14',
                target: '12'
            }, {
                source: 'a',
                target: '0'
            }, {
                source: 'a',
                target: '12'
            },{
                source: 'a',
                target: '15'
            }, {
                source: 'a',
                target: '11'
            }
            , {
                source: 'a',
                target: '1'
            },{
                source: '14',
                target: '15'
            }, {
                source: '11',
                target: '0'
            }
            , {
                source: '14',
                target: '1'
            },{
                source: '14',
                target: '12'
            }
            ],
            categories: categories,
            focusNodeAdjacency: true,
            roam: true,
            label: {
                normal: {
                    position: 'right',
                    formatter: '{b}'
                }
            },
            lineStyle: {
                normal: {
                    color: 'source',
                    curveness: 0.3
                }
            }
        }
        ]
    };
    myChart.setOption(option);





// 线条
/*
line: [
    {
        source: '相关联的传感器id',
        lineStyle:{
            color:'red',
            width:10
        },
        target: '相关联的传感器id'
    }
]
*/

/*
point: [{
        "id": "传感器id",
        "name": "各传感器名称",
        "symbolSize": '传感器异常次数',
        "attributes": {
            "modularity_class": 0
        },
        "value": '传感器异常次数',
        "label": {
            "normal": {
                "show": true
            }
        },
        "category": '同一类目的id'
    }, 
]

*/
/*{
    point:[
        {
            'sensor_id':'sfai',
            'sensor_name':'sdfg',
            'sensor_type':'sdf',
            'abnormal_num':12
        },
        {
            'sensor_id':'sfai',
            'sensor_name':'sdfg',
            'sensor_type':'sdf',
            'abnormal_num':12
        },
    ],
    line:[
        {
            'sensor_name_from':'sdf',
            'sensor_name_to':'sdf',
            'relation_label':10,
            'relation_type':'ddd'
        },
        {
            'sensor_name_from':'sdf',
            'sensor_name_to':'sdf',
            'relation_label':10,
            'relation_type':'ddd'
        },
    ]
}*/


function getPointData(point){
    if(!point || point.length===0){return []}
    let seriesData = [];
    let categoryArr = [];
    for(let i=0;i<point.length;i++){
        if(!categoryArr.includes(point[i].sensor_type_name)){
            categoryArr.push(point[i].sensor_type_name)
        }
        seriesData.push({
            "id": point[i].sensor_id,
            "name": point[i].sensor_name,
            "symbolSize": point[i].abnormal_num,
            "attributes": {
                "modularity_class": 0
            },
            "value": point[i].abnormal_num,
            "label": {
                "normal": {
                    "show": true
                }
            },
            "category": point[i].sensor_type   
        })
    }
    return {
        seriesData,
        categoryArr
    }
}

function getLine(line){
    if(!line || line.length===0){return []}
    let lineData = [];
    for(let i=0;i<line.length;i++){
        lineData.push({
            source: line[i].sensor_name_from,
            lineStyle:{
                width:line[i].relation_label,
            },
            target: line[i].sensor_name_to
        })
    }
}

</script>
</html>